<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="shared-styles.html">

<dom-module id="my-view1">
  <template>
    <style include="shared-styles">
      :host {
        display: block;

        padding: 10px;
      }
    </style>

    <firebase-query id="sampleList"
      path="/sampleList"
      data={{sampleList}}>
    </firebase-query>

    <div class="card">
      <div class="circle">1</div>
      <h1>View One</h1>
      <ul>
        <template is="dom-repeat" items="[[sampleList]]" as="sample">
          <li>[[sample.name.first]]</li>
        </template>
      </ul>
      <button on-click="_addName">Add</button>
    </div>
  </template>

  <script>
    class MyView1 extends Polymer.Element {
      static get is() { return 'my-view1'; }
      _addName(){
        console.log("sdfe")
        new Promise(function(resolve, reject) {
          let req = new XMLHttpRequest();
          req.open("GET", "https://randomuser.me/api/");
          req.onload = function() {
              if (req.status === 200) {
                  resolve(req.response);
              } else {
                  reject(new Error(req.statusText));
              }
          };
   
          req.onerror = function() {
              reject(new Error("Network error"));
          };
   
          req.send();
        }).then((user)=>{
          console.log(user)
          this.$.sampleList.ref.push(JSON.parse(user).results[0])
        })
        
      }
    }
    window.customElements.define(MyView1.is, MyView1);
  </script>
</dom-module>
